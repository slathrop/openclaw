---
phase: 01-build-tooling
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - rolldown.config.js
  - package.json
autonomous: true

must_haves:
  truths:
    - "tsconfig.json no longer exists in repo root"
    - "tsdown.config.ts no longer exists in repo root"
    - ".oxlintrc.json and .oxfmtrc.jsonc no longer exist in repo root"
    - "No @types/* packages remain in devDependencies"
    - "No typescript, @typescript/native-preview, tsdown, tsx, oxlint, oxfmt, or oxlint-tsgolint remain in devDependencies"
    - "rolldown.config.js exists and defines 4 entry points matching the old tsdown config"
    - "pnpm install succeeds after dependency changes"
  artifacts:
    - path: "rolldown.config.js"
      provides: "JavaScript bundler configuration replacing tsdown.config.ts"
      contains: "defineConfig"
    - path: "package.json"
      provides: "Cleaned dependency tree with no TS-specific devDependencies"
      contains: "rolldown"
  key_links:
    - from: "rolldown.config.js"
      to: "src/index.ts"
      via: "input entry point (rolldown processes .ts natively without tsc)"
      pattern: "input.*src/index"
---

<objective>
Remove the TypeScript compilation toolchain and create a JavaScript bundler configuration.

Purpose: Eliminate all TypeScript-specific build dependencies, type-checking tools, and linting/formatting tools that will be replaced by JavaScript equivalents. Create the rolldown config that replaces tsdown for JS bundling. This is the "teardown" plan -- it removes the old before the new is wired in.

Output: Clean dependency tree with no TS tooling; rolldown.config.js ready for use.
</objective>

<execution_context>
@/Users/slathrop/.claude/get-shit-done/workflows/execute-plan.md
@/Users/slathrop/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-build-tooling/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove TypeScript toolchain files and dependencies</name>
  <files>package.json, tsconfig.json, tsdown.config.ts, .oxlintrc.json, .oxfmtrc.jsonc</files>
  <action>
1. Delete the following config files from the repo root:
   - `tsconfig.json`
   - `tsdown.config.ts`
   - `.oxlintrc.json`
   - `.oxfmtrc.jsonc`

2. Remove the following devDependencies from package.json using pnpm:
   ```
   pnpm remove typescript @typescript/native-preview tsdown tsx oxlint oxfmt oxlint-tsgolint
   pnpm remove @types/express @types/markdown-it @types/node @types/proper-lockfile @types/qrcode-terminal @types/ws @grammyjs/types
   ```

   Note: `@grammyjs/types` is in devDependencies as a type package. Remove it along with the @types/* packages.

3. Verify no @types/* packages remain in devDependencies by checking package.json.

4. Run `pnpm install` to update the lockfile.

IMPORTANT: Do NOT modify any package.json scripts yet -- that happens in Plan 03. Do NOT remove `rolldown` from devDependencies -- it stays (already present as a devDependency at 1.0.0-rc.2).

IMPORTANT: Keep `vitest` and `@vitest/coverage-v8` in devDependencies -- they stay.
  </action>
  <verify>
- `ls tsconfig.json tsdown.config.ts .oxlintrc.json .oxfmtrc.jsonc 2>&1` should report "No such file" for all four
- `grep -c '@types/' package.json` returns 0
- `grep -c 'typescript' package.json` returns 0 (no typescript, no @typescript/native-preview)
- `grep -c 'tsdown' package.json` returns 0
- `grep -c 'oxlint' package.json` returns 0
- `grep -c 'oxfmt' package.json` returns 0
- `pnpm install` exits 0
  </verify>
  <done>All TypeScript-specific config files deleted. All TS-specific devDependencies removed. pnpm install succeeds with clean lockfile.</done>
</task>

<task type="auto">
  <name>Task 2: Create rolldown.config.js with current .ts entry points</name>
  <files>rolldown.config.js</files>
  <action>
Create `rolldown.config.js` in the repo root. This replaces `tsdown.config.ts`.

The config must define the same 4 entry points that tsdown.config.ts had, adapted for rolldown's API:
- `tsdown` uses `entry`, rolldown uses `input`
- `tsdown` uses `fixedExtension`, rolldown does not need this (already .js)
- `tsdown` uses `dts: true` for plugin-sdk -- skip this (no TypeScript declarations needed)
- `tsdown` uses `env` for NODE_ENV injection -- use rolldown's `define` option instead

CRITICAL: The entry points must reference the CURRENT `.ts` filenames (e.g., `src/index.ts`) because source files have NOT been converted to .js yet (that happens in Phase 2+). Rolldown can process .ts files natively -- it strips type annotations using its built-in transform (same engine as esbuild/tsdown). This is NOT invoking the TypeScript compiler (tsc). The rolldown config will be updated to reference .js files when source files are actually converted in Phase 2+.

```javascript
// rolldown.config.js
// Bundles source into dist/ for production.
// Replaces the previous tsdown configuration.
// Entry points reference .ts files (rolldown strips types natively, no tsc needed).
// These will be updated to .js when source files convert in Phase 2+.
import { defineConfig } from 'rolldown';

export default defineConfig([
  {
    input: 'src/index.ts',
    output: {
      dir: 'dist',
      format: 'esm'
    },
    platform: 'node',
    define: {
      'process.env.NODE_ENV': JSON.stringify('production')
    }
  },
  {
    input: 'src/entry.ts',
    output: {
      dir: 'dist',
      format: 'esm'
    },
    platform: 'node',
    define: {
      'process.env.NODE_ENV': JSON.stringify('production')
    }
  },
  {
    input: 'src/plugin-sdk/index.ts',
    output: {
      dir: 'dist/plugin-sdk',
      format: 'esm'
    },
    platform: 'node',
    define: {
      'process.env.NODE_ENV': JSON.stringify('production')
    }
  },
  {
    input: 'src/extensionAPI.ts',
    output: {
      dir: 'dist',
      format: 'esm'
    },
    platform: 'node',
    define: {
      'process.env.NODE_ENV': JSON.stringify('production')
    }
  }
]);
```

Use single quotes, 2-space indent, no trailing commas -- matching the target Google Style with the no-trailing-comma deviation.
  </action>
  <verify>
- `node -e "import('./rolldown.config.js').then(m => console.log(JSON.stringify(Object.keys(m))))"` exits 0 and prints `["default"]`
- File uses single quotes, 2-space indent, no trailing commas
- File contains all 4 entry points: src/index.ts, src/entry.ts, src/plugin-sdk/index.ts, src/extensionAPI.ts
- The entry points reference .ts files (the currently-existing source files)
  </verify>
  <done>rolldown.config.js exists with 4 entry points referencing current .ts source files. Rolldown will process these natively (no tsc). File follows target code style. rolldown is importable from existing devDependency.</done>
</task>

</tasks>

<verification>
1. No TypeScript config files exist: `ls tsconfig.json tsdown.config.ts .oxlintrc.json .oxfmtrc.jsonc 2>&1` all report "No such file"
2. No TS-specific devDependencies remain: `grep -E '(typescript|tsdown|tsx|oxlint|oxfmt|@types/)' package.json` returns nothing
3. rolldown.config.js is valid ESM: `node -e "import('./rolldown.config.js').then(() => console.log('ok'))"` prints "ok"
4. pnpm install succeeds: `pnpm install` exits 0
5. `pnpm exec rolldown -c rolldown.config.js` succeeds (rolldown processes .ts entry points natively)
</verification>

<success_criteria>
- Zero TypeScript config files in repo root (tsconfig.json, tsdown.config.ts, .oxlintrc.json, .oxfmtrc.jsonc all gone)
- Zero TS-specific devDependencies (typescript, @typescript/native-preview, tsdown, tsx, oxlint, oxfmt, oxlint-tsgolint, all @types/* packages)
- rolldown.config.js exists with correct 4-entry-point configuration referencing current .ts source files
- pnpm install succeeds
- pnpm build bundling step succeeds (rolldown strips types natively without tsc)
</success_criteria>

<output>
After completion, create `.planning/phases/01-build-tooling/01-01-SUMMARY.md`
</output>
