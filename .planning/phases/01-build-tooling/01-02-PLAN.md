---
phase: 01-build-tooling
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - eslint.config.js
  - package.json
autonomous: true

must_haves:
  truths:
    - "ESLint 9 flat config exists at eslint.config.js"
    - "Running eslint --help shows ESLint is installed and executable"
    - "Config enforces Google Style rules: 2-space indent, single quotes, always semicolons, no trailing commas"
    - "Config includes JSDoc validation via eslint-plugin-jsdoc for src/**/*.js files"
    - "Config defines ESM source type and Node.js globals"
    - "Config ignores dist/, node_modules/, assets/, vendor/, patches/, skills/, docs/_layouts/"
  artifacts:
    - path: "eslint.config.js"
      provides: "ESLint flat config with Google Style + JSDoc + ESM enforcement"
      contains: "defineConfig"
      min_lines: 60
  key_links:
    - from: "eslint.config.js"
      to: "@stylistic/eslint-plugin"
      via: "plugin import"
      pattern: "import.*@stylistic/eslint-plugin"
    - from: "eslint.config.js"
      to: "eslint-plugin-jsdoc"
      via: "plugin import"
      pattern: "import.*eslint-plugin-jsdoc"
---

<objective>
Install and configure ESLint 9 with Google Standard JavaScript Style, JSDoc validation, and ESM enforcement.

Purpose: Replace the oxlint + oxfmt + tsgo trio with a single unified linting and formatting tool (ESLint + Stylistic plugin). This gives fine-grained control over the Google Style rules while allowing the no-trailing-comma deviation the team requires.

Output: eslint.config.js with all rules configured; ESLint dependencies installed.
</objective>

<execution_context>
@/Users/slathrop/.claude/get-shit-done/workflows/execute-plan.md
@/Users/slathrop/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-build-tooling/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install ESLint dependencies</name>
  <files>package.json</files>
  <action>
Install the ESLint ecosystem as devDependencies:

```bash
pnpm add -D eslint @eslint/js @stylistic/eslint-plugin eslint-plugin-jsdoc globals
```

These replace the old oxlint + oxfmt + tsgo trio. After install, verify the packages appear in devDependencies in package.json.

IMPORTANT: Do NOT remove any existing packages in this task. Plan 01 handles removals. If Plan 01 has already run, the old packages will be gone. If not, they may still be present -- that is fine; this plan only adds.

IMPORTANT: Do NOT modify package.json scripts yet -- that happens in Plan 03.
  </action>
  <verify>
- `pnpm exec eslint --version` prints a version starting with "v9"
- `grep '"eslint"' package.json` shows eslint in devDependencies
- `grep '@stylistic/eslint-plugin' package.json` shows the plugin in devDependencies
- `grep 'eslint-plugin-jsdoc' package.json` shows the plugin in devDependencies
- `grep '"globals"' package.json` shows globals in devDependencies
  </verify>
  <done>ESLint 9, @eslint/js, @stylistic/eslint-plugin, eslint-plugin-jsdoc, and globals are installed as devDependencies.</done>
</task>

<task type="auto">
  <name>Task 2: Create eslint.config.js with Google Style rules</name>
  <files>eslint.config.js</files>
  <action>
Create `eslint.config.js` in the repo root. This is the ESLint 9 flat config that replaces .oxlintrc.json (linting), .oxfmtrc.jsonc (formatting), and tsgo (type-checking -- dropped entirely for JS).

The config must have three sections:

**Section 1: Global ignores** -- replaces .oxlintrc.json ignorePatterns + .oxfmtrc.jsonc ignorePatterns
**Section 2: Base JavaScript rules + Google Style formatting** -- replaces oxlint correctness/perf/suspicious categories + oxfmt formatting
**Section 3: JSDoc validation** -- new, for src/**/*.js files only

Use the exact config structure from the research, with these important details:

1. Global ignores should cover: `assets/`, `dist/`, `docs/_layouts/`, `node_modules/`, `patches/`, `skills/`, `src/canvas-host/a2ui/a2ui.bundle.js`, `vendor/`, `apps/` (carried over from .oxfmtrc.jsonc)

2. For max-len: Start with `['warn', { code: 100, ... }]` (warning, 100 chars) as recommended by research to avoid noise during conversion. The ignoreUrls/ignoreStrings/ignoreTemplateLiterals/ignoreRegExpLiterals exceptions must all be true.

3. For comma-dangle: Must be `['error', 'never']` -- this is the DEVIATION from Google Style. Google requires trailing commas; this project prohibits them.

4. JSDoc section: Use `jsdoc.configs['flat/recommended']` as the base, then override `jsdoc/require-jsdoc` to `'off'` (don't require JSDoc everywhere) and keep validation rules as errors for any JSDoc that IS present.

5. Use `import { defineConfig, globalIgnores } from 'eslint/config'` for the flat config API.

6. File patterns: Use `['**/*.js', '**/*.mjs']` for base and stylistic rules. Use `['src/**/*.js']` for JSDoc rules.

```javascript
// eslint.config.js
// Unified linting and formatting configuration.
// Implements Google Standard JavaScript Style with one deviation:
// no trailing commas (Google requires them; this project prohibits them).
import { defineConfig, globalIgnores } from 'eslint/config';
import js from '@eslint/js';
import stylistic from '@stylistic/eslint-plugin';
import jsdoc from 'eslint-plugin-jsdoc';
import globals from 'globals';

export default defineConfig([
  globalIgnores([
    'apps/',
    'assets/',
    'dist/',
    'docs/_layouts/',
    'node_modules/',
    'patches/',
    'skills/',
    'src/canvas-host/a2ui/a2ui.bundle.js',
    'vendor/'
  ]),

  // Base JavaScript rules (Google Style)
  {
    name: 'base/recommended',
    files: ['**/*.js', '**/*.mjs'],
    extends: [js.configs.recommended],
    languageOptions: {
      ecmaVersion: 'latest',
      sourceType: 'module',
      globals: {
        ...globals.node,
        ...globals.es2025
      }
    },
    rules: {
      'no-var': 'error',
      'prefer-const': 'error',
      eqeqeq: ['error', 'always'],
      curly: ['error', 'all'],
      'prefer-arrow-callback': 'error',
      'prefer-template': 'error',
      'prefer-rest-params': 'error',
      'prefer-spread': 'error'
    }
  },

  // Stylistic / formatting rules (Google Style with no-trailing-comma deviation)
  {
    name: 'style/google-modified',
    files: ['**/*.js', '**/*.mjs'],
    plugins: {
      '@stylistic': stylistic
    },
    rules: {
      '@stylistic/indent': ['error', 2],
      '@stylistic/quotes': ['error', 'single', { avoidEscape: true }],
      '@stylistic/semi': ['error', 'always'],
      // DEVIATION: Google Style requires trailing commas ('always-multiline').
      // This project prohibits them.
      '@stylistic/comma-dangle': ['error', 'never'],
      '@stylistic/space-before-blocks': 'error',
      '@stylistic/keyword-spacing': 'error',
      '@stylistic/space-infix-ops': 'error',
      '@stylistic/comma-spacing': ['error', { before: false, after: true }],
      '@stylistic/max-len': ['warn', {
        code: 100,
        ignoreUrls: true,
        ignoreStrings: true,
        ignoreTemplateLiterals: true,
        ignoreRegExpLiterals: true
      }]
    }
  },

  // JSDoc validation (validate what's present; don't require it everywhere)
  {
    name: 'jsdoc/recommended',
    files: ['src/**/*.js'],
    extends: [jsdoc.configs['flat/recommended']],
    rules: {
      'jsdoc/require-jsdoc': 'off',
      'jsdoc/check-param-names': 'error',
      'jsdoc/check-tag-names': 'error',
      'jsdoc/check-types': 'error',
      'jsdoc/valid-types': 'error'
    }
  }
]);
```

Style: single quotes, 2-space indent, no trailing commas, always semicolons. The config file itself should follow the style it enforces.
  </action>
  <verify>
- `node -e "import('./eslint.config.js').then(() => console.log('ok'))"` prints "ok" (config is valid ESM)
- `grep "comma-dangle.*never" eslint.config.js` finds the trailing comma deviation
- `grep "require-jsdoc.*off" eslint.config.js` finds the JSDoc override
- The file itself uses single quotes, 2-space indent, no trailing commas, always semicolons
- `wc -l eslint.config.js` shows 70+ lines (comprehensive config, not a stub)
  </verify>
  <done>eslint.config.js exists with Google Style base rules, stylistic formatting rules (with no-trailing-comma deviation), JSDoc validation for src/**/*.js, ESM source type, Node.js globals, and comprehensive ignore patterns.</done>
</task>

</tasks>

<verification>
1. ESLint is installed and runnable: `pnpm exec eslint --version` outputs v9.x
2. eslint.config.js is valid ESM: `node -e "import('./eslint.config.js').then(() => console.log('ok'))"` prints "ok"
3. Config enforces no trailing commas: `grep "comma-dangle.*never" eslint.config.js` matches
4. Config has JSDoc validation: `grep "eslint-plugin-jsdoc" eslint.config.js` matches
5. All 5 ESLint packages in devDependencies: eslint, @eslint/js, @stylistic/eslint-plugin, eslint-plugin-jsdoc, globals
</verification>

<success_criteria>
- ESLint 9 and all plugins installed as devDependencies
- eslint.config.js exists with three rule sections: base JS, stylistic, JSDoc
- Google Style rules configured: 2-space indent, single quotes, always semicolons, no trailing commas
- JSDoc validation enabled for src/**/*.js (validate present docs, don't require docs everywhere)
- ESM source type and Node.js globals configured
- Ignore patterns cover all non-source directories
</success_criteria>

<output>
After completion, create `.planning/phases/01-build-tooling/01-02-SUMMARY.md`
</output>
