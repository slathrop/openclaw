---
phase: 09-threading-features
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - CONTRIBUTING.md
  - docs/providers/ollama.md
  - docs/zh-CN/providers/ollama.md
  - src/entry.js
  - CHANGELOG.md
autonomous: true
user_setup: []

must_haves:
  truths:
    - "CONTRIBUTING.md handle updated"
    - "Ollama docs use model.fallbacks (not model.fallback)"
    - "Entry point respawn uses CLI flag instead of NODE_OPTIONS"
  artifacts:
    - path: "CONTRIBUTING.md"
      provides: "Updated contributor handle"
    - path: "docs/providers/ollama.md"
      provides: "Corrected model.fallbacks reference"
      contains: "model\\.fallbacks"
    - path: "src/entry.js"
      provides: "Respawn without NODE_OPTIONS"
      contains: "disable-warning|execPath"
  key_links:
    - from: "src/entry.js"
      to: "process.execPath spawn"
      via: "CLI flag passed directly to node instead of NODE_OPTIONS env var"
      pattern: "spawn.*execPath|disable-warning"
---

<objective>
Port contributor handle update, Ollama docs fix, and CLI NODE_OPTIONS respawn fix (SYNC-046 to SYNC-048)

Purpose: Apply three independent small changes: a chore, a docs fix, and a CLI entry point fix
Output: Three commits matching upstream (SYNC-046, SYNC-047, SYNC-048)
</objective>

<execution_context>
@/Users/slathrop/.claude/get-shit-done/workflows/execute-plan.md
@/Users/slathrop/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-threading-features/09-RESEARCH.md
</context>

<upstream_workflow>
For each commit in this plan:
1. Fetch and show upstream diff: `git fetch upstream && git show <hash> --stat && git show <hash>`
2. Understand the change (read PR if needed: `gh pr view <number> --repo openclaw/openclaw`)
3. Apply equivalent JavaScript change to local files
4. Run targeted tests: `pnpm vitest run <relevant-test-file>`
5. Commit with --no-verify (wave-level test gate handles full suite): `scripts/committer --no-verify "<message>" <files...>`
</upstream_workflow>

<tasks>

<task type="auto">
  <name>Task 1: SYNC-046 - Update contributor handle</name>
  <files>CONTRIBUTING.md</files>
  <action>
Port commit 1473fb19a (update handle)

1. Read the upstream diff:
   ```bash
   git fetch upstream
   git show 1473fb19a --stat
   git show 1473fb19a
   ```

2. Apply the change:
   - This is a trivial chore: updating a contributor handle in CONTRIBUTING.md
   - Apply the exact text change from upstream

3. Commit:
   ```bash
   scripts/committer --no-verify "update handle" CONTRIBUTING.md
   ```
  </action>
  <verify>`git log -1` shows correct message, `git diff HEAD~1 CONTRIBUTING.md` shows only the handle change</verify>
  <done>Commit 1473fb19a ported as SYNC-046</done>
</task>

<task type="auto">
  <name>Task 2: SYNC-047 - Fix model.fallback to model.fallbacks in docs</name>
  <files>docs/providers/ollama.md, docs/zh-CN/providers/ollama.md</files>
  <action>
Port commit 679bb087d (docs: fix model.fallback to model.fallbacks (#9384))

1. Read the upstream diff:
   ```bash
   git show 679bb087d --stat
   git show 679bb087d
   ```

2. Apply the change:
   - This is a docs-only fix: `model.fallback` should be `model.fallbacks` (plural)
   - Apply to both English and zh-CN versions of the Ollama provider docs
   - Simple find-and-replace in the relevant sections

3. Commit:
   ```bash
   scripts/committer --no-verify "docs: fix model.fallback to model.fallbacks (#9384)" docs/providers/ollama.md docs/zh-CN/providers/ollama.md
   ```

Note: If zh-CN file doesn't exist or differs, apply only what exists. The upstream commit targets both locales.
  </action>
  <verify>`git log -1` shows correct message, `grep -c 'model.fallbacks' docs/providers/ollama.md` shows the fix applied</verify>
  <done>Commit 679bb087d ported as SYNC-047, Ollama docs reference model.fallbacks correctly</done>
</task>

<task type="auto">
  <name>Task 3: SYNC-048 - Avoid NODE_OPTIONS for --disable-warning</name>
  <files>src/entry.js, CHANGELOG.md</files>
  <action>
Port commit ea237115a (fix(cli): avoid NODE_OPTIONS for --disable-warning (#9691))

1. Read the upstream diff:
   ```bash
   git show ea237115a --stat
   git show ea237115a
   ```

2. Understand the change:
   - The entry point currently sets NODE_OPTIONS env var with `--disable-warning=ExperimentalWarning`
   - This causes issues with `npm pack` on modern Node.js versions
   - The fix: instead of setting NODE_OPTIONS, pass the flag directly to the spawned node process via CLI args
   - The respawn mechanism changes from env-var-based to arg-based

3. Apply the equivalent JavaScript changes to src/entry.js:
   - Remove the NODE_OPTIONS manipulation
   - Pass `--disable-warning=ExperimentalWarning` (or equivalent flag) directly as a CLI argument to `process.execPath` in the spawn call
   - The spawn should look like:
     ```javascript
     spawn(process.execPath, [EXPERIMENTAL_WARNING_FLAG, ...process.execArgv, ...process.argv.slice(1)], {stdio: 'inherit', env: process.env})
     ```
   - Update the respawn detection logic accordingly (check process.execArgv instead of NODE_OPTIONS)
   - Update CHANGELOG.md with the fix entry

4. Run targeted tests:
   ```bash
   pnpm vitest run src/entry
   ```

5. Commit:
   ```bash
   scripts/committer --no-verify "fix(cli): avoid NODE_OPTIONS for --disable-warning (#9691)" src/entry.js CHANGELOG.md
   ```
  </action>
  <verify>`grep -q NODE_OPTIONS src/entry.js` should NOT match (or match only in comments), `git log -1` shows correct message</verify>
  <done>Commit ea237115a ported as SYNC-048, entry point uses CLI flag instead of NODE_OPTIONS for warning suppression</done>
</task>

</tasks>

<verification>
After all 3 tasks complete:
1. `git log -3 --oneline` shows three commits in correct order
2. CONTRIBUTING.md has updated handle
3. Ollama docs reference model.fallbacks
4. src/entry.js no longer uses NODE_OPTIONS for warning suppression
5. Commits match upstream messages:
   - update handle
   - docs: fix model.fallback to model.fallbacks (#9384)
   - fix(cli): avoid NODE_OPTIONS for --disable-warning (#9691)
</verification>

<success_criteria>
- 3 commits created matching SYNC-046, SYNC-047, SYNC-048
- Entry point respawn uses CLI flag instead of NODE_OPTIONS
- Docs typo fixed in both locales
- No regressions
</success_criteria>

<output>
After completion, create `.planning/phases/09-threading-features/09-02-SUMMARY.md`
</output>
